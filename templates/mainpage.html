<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pace Converter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/modern-style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèÉ</text></svg>">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üèÉ‚Äç‚ôÇÔ∏è Pace Converter</h1>
            <p>Calculate your running pace and predict race times with precision</p>
        </header>

        <!-- Error Message -->
        {% if error %}
        <div class="error-message">
            ‚ö†Ô∏è {{ error }}
        </div>
        {% endif %}

        <!-- Main Content -->
        <main class="main-content">
            <!-- Pace Converter Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Pace Conversion
                </h2>

                <form method="post">
                    <!-- Pace to Speed Section -->
                    <div class="form-section">
                        <div class="form-group">
                            <label for="pace-inputs">Pace (min/km)</label>
                            <div class="form-row">
                                <div class="input-group">
                                    <input type="number" id="minutes" name="minutes" value="{{ minutes if minutes > 0 else '' }}" min="0" max="59" placeholder="0">
                                    <span class="unit-label">min</span>
                                    <input type="number" id="seconds" name="seconds" value="{{ seconds if seconds > 0 else '' }}" min="0" max="59" placeholder="0">
                                    <span class="unit-label">sec</span>
                                </div>
                                <button type="submit" class="btn" name="converttokmperh" value="converttokmperh">
                                    Convert to km/h
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Speed to Pace Section -->
                    <div class="form-section">
                        <div class="form-group">
                            <label for="speed-input">Speed (km/h)</label>
                            <div class="form-row">
                                <div class="input-group">
                                    <input type="text" id="kmperhour" name="kmperhour" value="{{ pace if pace != '0' else '' }}" placeholder="0.0">
                                    <span class="unit-label">km/h</span>
                                </div>
                                <button type="submit" class="btn" name="converttominperkm" value="converttominperkm">
                                    Convert to min/km
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Race Time Section -->
                    <div class="form-section">
                        <div class="form-group">
                            <label for="race-inputs">Race Time</label>
                            <div class="form-row">
                                <div class="input-group">
                                    <select name="race_distance" id="race_distance">
                                        <option value="fivek" {% if race_distance == 'fivek' %}selected{% endif %}>5K</option>
                                        <option value="tenk" {% if race_distance == 'tenk' %}selected{% endif %}>10K</option>
                                        <option value="twentyk" {% if race_distance == 'twentyk' %}selected{% endif %}>20K</option>
                                        <option value="half" {% if race_distance == 'half' %}selected{% endif %}>Half Marathon</option>
                                        <option value="marathon" {% if race_distance == 'marathon' %}selected{% endif %}>Marathon</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <input type="number" name="race_hours" value="{{ race_hours if race_hours > 0 else '' }}" min="0" max="12" placeholder="0">
                                    <span class="unit-label">h</span>
                                    <input type="number" name="race_minutes" value="{{ race_minutes if race_minutes > 0 else '' }}" min="0" max="59" placeholder="0">
                                    <span class="unit-label">min</span>
                                    <input type="number" name="race_seconds" value="{{ race_seconds if race_seconds > 0 else '' }}" min="0" max="59" placeholder="0">
                                    <span class="unit-label">sec</span>
                                </div>
                                <button type="submit" class="btn" name="convertfromracetime" value="convertfromracetime">
                                    Calculate Pace
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Current Result Card -->
            {% if minutes > 0 or seconds > 0 or pace != '0' %}
            <div class="card">
                <h2 class="card-title">
                    <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    Current Result
                </h2>

                <div class="form-group">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                        <div style="text-align: center; padding: 1rem; background: var(--secondary-bg); border-radius: 8px;">
                            <div style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 0.5rem;">Pace</div>
                            <div style="font-size: 1.5rem; font-weight: 600; color: var(--accent-blue);">
                                {{ minutes }}:{{ '%02d'|format(seconds) }}
                            </div>
                            <div style="color: var(--text-muted); font-size: 0.8rem;">min/km</div>
                        </div>
                        <div style="text-align: center; padding: 1rem; background: var(--secondary-bg); border-radius: 8px;">
                            <div style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 0.5rem;">Speed</div>
                            <div style="font-size: 1.5rem; font-weight: 600; color: var(--accent-light);">
                                {{ pace }}
                            </div>
                            <div style="color: var(--text-muted); font-size: 0.8rem;">km/h</div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </main>

        <!-- Results Section -->
        {% if fivek and fivek != '0h0min0s' %}
        <section class="results-section">
            <div class="card">
                <h2 class="card-title">
                    <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Race Time Predictions
                </h2>

                <div class="results-table">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>
                                    <svg style="width: 16px; height: 16px; display: inline; margin-right: 0.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    </svg>
                                    Distance
                                </th>
                                <th>
                                    <svg style="width: 16px; height: 16px; display: inline; margin-right: 0.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    Predicted Time
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>5 kilometers</strong></td>
                                <td><code>{{ fivek }}</code></td>
                            </tr>
                            <tr>
                                <td><strong>10 kilometers</strong></td>
                                <td><code>{{ tenk }}</code></td>
                            </tr>
                            <tr>
                                <td><strong>20 kilometers</strong></td>
                                <td><code>{{ twentyk }}</code></td>
                            </tr>
                            <tr>
                                <td><strong>Half Marathon (21.1 km)</strong></td>
                                <td><code>{{ half }}</code></td>
                            </tr>
                            <tr>
                                <td><strong>Marathon (42.2 km)</strong></td>
                                <td><code>{{ marathon }}</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        {% endif %}

        <!-- Footer -->
        <footer class="footer">
        </footer>
    </div>

    <script>
        // Race distances in kilometers
        const raceDistances = {
            'fivek': 5.0,
            'tenk': 10.0,
            'twentyk': 20.0,
            'half': 21.0975,
            'marathon': 42.195
        };

        // Add smooth form interactions
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('input, select');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.parentElement.style.transform = 'scale(1.02)';
                });
                input.addEventListener('blur', function() {
                    this.parentElement.style.transform = 'scale(1)';
                });
            });

            // Add loading state to buttons
            const buttons = document.querySelectorAll('.btn');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.style.opacity = '0.8';
                    this.innerHTML = 'Calculating...';
                });
            });

            // Handle race distance change
            const raceDistanceSelect = document.getElementById('race_distance');
            const minutesInput = document.getElementById('minutes');
            const secondsInput = document.getElementById('seconds');
            const raceHoursInput = document.querySelector('input[name="race_hours"]');
            const raceMinutesInput = document.querySelector('input[name="race_minutes"]');
            const raceSecondsInput = document.querySelector('input[name="race_seconds"]');

            function updateRaceTime() {
                const selectedDistance = raceDistanceSelect.value;
                const minutes = parseInt(minutesInput.value) || 0;
                const seconds = parseInt(secondsInput.value) || 0;

                // If pace is cleared or zero, clear race time fields
                if ((minutesInput.value === '' && secondsInput.value === '') || (minutes === 0 && seconds === 0)) {
                    raceHoursInput.value = '';
                    raceMinutesInput.value = '';
                    raceSecondsInput.value = '';
                    return;
                }

                // Calculate if we have a valid pace
                if (minutes > 0 || seconds > 0) {
                    const distanceKm = raceDistances[selectedDistance];
                    if (distanceKm) {
                        const totalRaceSeconds = (minutes * 60 + seconds) * distanceKm;
                        const hours = Math.floor(totalRaceSeconds / 3600);
                        const mins = Math.floor((totalRaceSeconds % 3600) / 60);
                        const secs = Math.floor(totalRaceSeconds % 60);

                        raceHoursInput.value = hours > 0 ? hours : '';
                        raceMinutesInput.value = mins > 0 ? mins : '';
                        raceSecondsInput.value = secs > 0 ? secs : '';
                    }
                }
            }

            // Update race time when distance changes
            if (raceDistanceSelect) {
                raceDistanceSelect.addEventListener('change', updateRaceTime);
            }

            // Also update when pace changes
            if (minutesInput && secondsInput) {
                minutesInput.addEventListener('input', updateRaceTime);
                secondsInput.addEventListener('input', updateRaceTime);
            }
        });
    </script>
</body>
</html>